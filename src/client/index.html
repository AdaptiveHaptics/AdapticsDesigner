<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="style.css">
	<title>AdapticsDesigner</title>
	<link rel="icon" href="favicon.512.png" sizes="512x512" />
	<link rel="icon" href="favicon.192.png" sizes="192x192" />
	<link rel="icon" href="favicon.48.png" sizes="48x48" />
	<link rel="apple-touch-icon" href="favicon.512.png" sizes="512x512">
	<link rel="apple-touch-icon" href="favicon.192.png" sizes="192x192">
	<link rel="apple-touch-icon" href="favicon.48.png" sizes="48x48">
	<script src="./thirdparty/konva.min.js" defer></script>
	<script src="./js/script.mjs" type="module"></script>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>

<body>
	<div class="app">
		<div class="titlebar">
			<div class="isection file">
				<div class="filemenu">
					<button class="file"><span class="material-symbols-outlined">menu</span>File</button>
					<div class="menulist">
						<button class="new" title="Create new pattern"><span class="material-symbols-outlined">note_add</span> New</button>
						<button class="open" title="Open a file"><span class="material-symbols-outlined">folder_open</span> Open</button>
						<button class="download" title="Use standard browser file download"><span class="material-symbols-outlined">download</span> Download</button>
						<button class="save" title="Save to last used file handle"><span class="material-symbols-outlined">save</span> Save</button>
						<button class="save_as" title="Save to new file"><span class="material-symbols-outlined">save_as</span> Save As</button>
					</div>
				</div>

				<!-- <span class="icon">ðŸ’¾</span> -->
				<span class="filename">LOADING</span>
				<span class="status savedstate">loading....</span>
			</div>
			<div class="verticalrule"></div>
			<div class="isection websocket">
				<span class="icon">â¥®</span>
				<input class="websocketurl" type="text" value="ws://127.0.0.1:8037/">
				<button class="connect">Connect</button>
				<button class="disconnect" style="display: none;">Disconnect</button>
				<span class="status websocketstate">disconnected</span>
				<a href="https://github.com/AdaptiveHaptics/AdapticsEngine/releases/latest/download/adaptics-engine-cli.exe" title="Download CLI Application for Device Playback"><span class="material-symbols-outlined">browser_updated</span></a>
			</div>
			<div class="verticalrule"></div>
			<a href="https://github.com/AdaptiveHaptics/AdapticsDesigner" target="_blank" rel="noopener noreferrer" title="View on GitHub">
				<img src="./thirdparty/github-mark-white.svg" alt="GitHub">
				<!-- <span class="material-symbols-outlined">code</span> -->
			</a>
		</div>
		<div class="mainsplitgrid">
			<div class="left">
				<div class="designlibrary">
					<div class="searchbox">
						<label>
							<span class="material-symbols-outlined">search</span>
							<input type="text" placeholder="Search Design Library">
						</label>
						<button class="material-symbols-outlined close">close</button>
					</div>
					<div class="designtree">
						<div class="children">
							<details class="folder">
								<summary>LOADING... Examples</summary>
								<div class="children">
									<button class="file">Battery</button>
									<button class="file">Spin</button>
									<details class="folder">
										<summary>Buttons</summary>
										<div class="children">
											<button class="file">ButtonA</button>
											<button class="file">ButtonB</button>
										</div>
									</details>
									<button class="file">Slider</button>
								</div>
							</details>
							<button class="file">LOADING... Test1</button>
							<button class="file">LOADING... Test2</button>
						</div>
					</div>
				</div>
			</div>
			<div class="gutter column leftcenter"></div>
			<div class="center konvastagecontainer" tabindex="0">
				<div class="contextmenu" style="visibility: hidden;">
					<div class="menulist">
						<div class="nested">
							<span class="nestedtitle"><span class="material-symbols-outlined">add</span>Add Keyframe</span>
							<div class="menulist">
								<button class="addkf noicon" data-type="standard" title="Standard keyframe with coords, brush, intensity, and transitions">Standard</button>
								<button class="addkf noicon" data-type="pause" title="Holds brush at the previous keyframe's position">Hold Position</button>
								<button class="addkf noicon" data-type="stop" title="Stops the animation, and pauses playback on the device">Stop</button>
							</div>
						</div>
						<button title="Delete Selected Keyframes" disabled><span class="material-symbols-outlined">close</span> Delete Selected</button>
						<button title="Copy Selected Keyframes" disabled><span class="material-symbols-outlined">content_copy</span>Copy</button>
						<button title="Paste Keyframes From Clipboard" disabled><span class="material-symbols-outlined">content_paste</span>Paste</button>

					</div>
				</div>
				<div id="patternstage" class="konvastage patternstage"></div>
			</div>
			<div class="gutter column centerright"></div>
			<div class="right">
				<div class="tabs">
					<button class="tab active" data-tabpanel="help"><span class="material-symbols-outlined">info</span> Editor Help</button>
					<button class="tab" data-tabpanel="ukfecontainer"><span class="material-symbols-outlined">auto_awesome_motion</span> Keyframe Editor</button>
					<button class="tab" data-tabpanel="pattern"><span class="material-symbols-outlined">lens_blur</span> Post Processing</button>
				</div>
				<div class="tabpanelcontainer betterscroll">
					<div class="help">
						<h1>Editor Help</h1>
						<p>
							<h4>To create a new keyframe, <code>Right Click</code>, or <code>Double Click</code></h4>
							<ul>
								<li>in background of the Pattern Pane</li>
								<li>within the Keyframe Track of the Timeline Pane</li>
							</ul>
						</p>
						<p>
							<h4>To select all, focus* an editor pane and <code>Ctrl+a</code></h4>
							<ul>
								<li>with the Pattern Pane focused, only select keyframes with coordinates</li>
								<li>with the Timeline Pane focused, select all keyframes</li>
							</ul>
							<sub>* Focus a pane by clicking within it. Focus is indicated by a light steel blue border</sub>
						</p>
						<p>
							<h4>Clicking a control point/keyframe:</h4>
							<ul>
								<li><code>Alt+Click</code> is deletion</li>
								<li><code>Ctrl+Click</code> toggles selection</li>
							</ul>
						</p>
						<p>
							<h4>During group selection (click and drag):</h4>
							<ul>
								<li><code>Ctrl</code> is union/addition to selection</li>
								<li><code>Ctrl+Shift</code> is subtraction from selection</li>
								<li><code>Alt</code> includes linked keyframes</li>
							</ul>
						</p>
					</div>
					<form class="pattern">
						<div class="header">
							<h2>Post Processing Transformations</h2>
							<button type="reset">RESET</button>
						</div>
						<div class="transformcontrol labelinputgrid">
							<!-- controls added in pattern-globals-editor.mjs -->
						</div>
					</form>
					<div class="ukfecontainer">
						<h1>Keyframe Editor</h1>
						<div class="helptext">
							<div>Select one or more keyframes to edit them in this space.</div>
							<div>The properties of the selected keyframes will be merged.</div>
							<div>If a certain property varies across the selected keyframes, the corresponding field may remain blank or display 'multiple values'.</div>
						</div>
						<form class="ukfe">
							<div class="typecontainer">
								<label>Type</label>
								<select name="keyframetype" class="keyframe type">
									<option hidden disabled selected value="multipletypes">multiple types</option>
									<option value="standard" title="Standard keyframe with coords, brush, intensity, and transitions">standard</option>
									<option value="pause" title="Holds brush at the previous keyframe's position">hold position</option>
									<option value="stop" title="Stops the animation, and pauses playback on the device">stop</option>
								</select>
							</div>
							<details class="coords">
								<summary><span class="material-symbols-outlined">my_location</span>Coords</summary>
								<div>
									<div class="coordsconfig labelinputgrid">
										<label><span class="labeltext">x<span class="unit"> mm</span></span><input type="number" name="x" min="-100" max="100"></label>
										<label><span class="labeltext">y<span class="unit"> mm</span></span><input type="number" name="y" min="-100" max="100"></label>
										<label><span class="labeltext">z<span class="unit"> mm</span></span><input disabled type="number" name="z" min="0" max="100"></label>
									</div>
									<hr class="transitionsep">
									<div class="transition">
										<!-- <h4>Transition</h4> -->
										<div class="transitionconfig">
											<label>
												<span class="labeltext">Transition Type</span>
											</label>
											<select name="coordstransitiontype" class="coords transition type">
												<option hidden disabled selected value="multipletypes">multiple types</option>
												<option value="linear" title="Linear interpolation between the keyframes">linear</option>
												<option value="step" title="Step/Jump between the keyframes">step</option>
											</select>
										</div>
									</div>
								</div>
							</details>
							<details class="brush">
								<summary><span class="material-symbols-outlined">brush</span>Brush</summary>
								<div class="brushconfig labelinputgrid">
									<label><span class="labeltext">Brush Type</span></label>
									<select name="brushtype" class="brush type">
										<option hidden disabled selected value="multipletypes">multiple types</option>
										<option disabled value="omitted">omitted</option>
										<option value="circle">circle</option>
										<option value="line">line</option>
									</select>
									<!-- 'dynamic-f64-input's added in javascript unified-keyframe-editor.mjs -->
								</div>
								<hr class="transitionsep">
								<div class="transition">
									<!-- <h4>Transition</h4> -->
									<div class="transitionconfig">
										<label>
											<span class="labeltext">Transition Type</span>
										</label>
										<select name="brushtransitiontype" class="brush transition type">
											<option hidden disabled selected value="multipletypes">multiple types</option>
											<option value="linear" title="Linear interpolation between the keyframes">linear</option>
											<option value="step" title="Step/Jump between the keyframes">step</option>
										</select>
									</div>
								</div>
							</details>
							<details class="intensity">
								<summary><span class="material-symbols-outlined">infrared</span>Intensity</summary>
								<div class="intensityconfig labelinputgrid">
									<label><span class="labeltext">Intensity Type</span></label>
									<select name="intensitytype" class="intensity type">
										<option hidden disabled selected value="multipletypes">multiple types</option>
										<option disabled value="omitted">omitted</option>
										<option value="constant">constant</option>
										<option value="random">random</option>
									</select>

								</div>
								<hr class="transitionsep">
								<div class="transition">
									<!-- <h4>Transition</h4> -->
									<div class="transitionconfig">
										<label>
											<span class="labeltext">Transition Type</span>
										</label>
										<select name="intensitytransitiontype" class="intensity transition type">
											<option hidden disabled selected value="multipletypes">multiple types</option>
											<option value="linear" title="Linear interpolation between the keyframes">linear</option>
											<option value="step" title="Step/Jump between the keyframes">step</option>
										</select>
									</div>
								</div>
							</details>
							<details class="cjump">
								<summary><span class="material-symbols-outlined">alt_route</span>Conditional Jump</summary>
								<div class="cjumpconfig">
									<div class="table">
										<div class="thead">
											<div>
												<div style="visibility: hidden;"><span class="material-symbols-outlined">drag_handle</span></div>
												<div><span class="labeltext">Parameter</span></div>
												<div><span class="labeltext">Operator</span></div>
												<div><span class="labeltext">Value</span></div>
												<div><span class="labeltext">Jump To Time<span class="unit"> ms</span></span></div>
												<button class="remove" style="visibility: hidden;">âœ–</button>
											</div>
										</div>
										<div class="tbody cjumps-container">
											<!--  template.cjump clones into here  -->
										</div>
									</div>
									<button class="add">+ Add Conditional Jump</button>
									<template class="cjumprow">
										<div class="cjump">
											<div class="draghandle"><span class="material-symbols-outlined">drag_handle</span></div>
											<input type="text" name="parameter">
											<select name="conditionoperatortype" class="conditionoperator type">
												<option hidden disabled selected value="multipletypes">multiple types</option>
												<option value="lt">&lt;</option>
												<option value="lt_eq">&lt;=</option>
												<option value="gt">&gt;</option>
												<option value="gt_eq">&gt;=</option>
											</select>
											<input type="number" name="value" step="0.05">
											<input type="number" name="jump_to" min="0">
											<button class="remove">âœ–</button>
										</div>
									</template>
								</div>
							</details>
						</form>
					</div>
				</div>
				<div class="actionbuttons" style="display: none;">
					<button title="Add Keyframe" class="addkeyframe"><span class="material-symbols-outlined">add</span>Add Keyframe</button>
					<button title="Delete Selected Keyframes" class="deletekeyframes"><span class="material-symbols-outlined">close</span>Delete Selected</button>
				</div>
			</div>
			<div class="gutter row topbottom"></div>
			<div class="bottom">
				<div class="parametereditor betterscroll">
					<!-- <h1>Parameters <span class="material-symbols-outlined">tune</span></h1> -->
					<div class="playback">
						<h2>Playback <span class="material-symbols-outlined">slow_motion_video</span> <span class="material-symbols-outlined warning">warning</span></h2>
						<div class="timecontrol">
							<label><span class="labeltext"><span class="material-symbols-outlined">av_timer</span>Time<span class="unit"> ms</span></span><input type="number" name="time" min="0" step="1"></label>
							<button class="reset"><span class="material-symbols-outlined">restart_alt</span></button>
							<button class="play"><span class="material-symbols-outlined">play_arrow</span></button>
							<button class="pause" style="display: none;"><span class="material-symbols-outlined">pause</span></button>
						</div>
					</div>
					<div class="userparamscontainer">
						<h2>
							User/Dynamic
							<span class="material-symbols-outlined">discover_tune</span>
							<span></span>
							<button class="reset" type="button" title="Reset"><span class="material-symbols-outlined">restart_alt</span></button>
						</h2>
						<div class="userparameters">
							<div><span>Name</span><span></span><span>Value</span><span></span></div>
						</div>
						<button class="addparam">+ Add Parameter</button>
					</div>
				</div>
				<div class="gutter column"></div>
				<div class="timeline konvastagecontainer" tabindex="0">
					<div class="contextmenu" style="visibility: hidden;">
						<div class="menulist">
							<div class="nested">
								<span class="nestedtitle"><span class="material-symbols-outlined">add</span>Add Keyframe</span>
								<div class="menulist">
									<button class="addkf noicon" data-type="standard" title="Standard keyframe with coords, brush, intensity, and transitions">Standard</button>
									<button class="addkf noicon" data-type="pause" title="Holds brush at the previous keyframe's position">Hold Position</button>
									<button class="addkf noicon" data-type="stop" title="Stops the animation, and pauses playback on the device">Stop</button>
								</div>
							</div>
							<button title="Delete Selected Keyframes" disabled><span class="material-symbols-outlined">close</span> Delete Selected</button>
							<button title="Copy Selected Keyframes" disabled><span class="material-symbols-outlined">content_copy</span>Copy</button>
							<button title="Paste Keyframes From Clipboard" disabled><span class="material-symbols-outlined">content_paste</span>Paste</button>

						</div>
					</div>
					<div id="timelinestage" class="konvastage timelinestage"></div>
				</div>
			</div>
		</div>
	</div>
	<dialog id="userparamdialog">
		<form method="dialog">
			<div class="dialogtitlebar">
				<span class="titletext add">Add Parameter Definition</span>
				<span class="titletext edit">Edit Parameter Definition</span>
				<button class="delete textonly" type="button" title="Delete Paramter"><span class="material-symbols-outlined">delete_forever</span></button>
				<button class="close" type="button" title="Close"><span class="material-symbols-outlined">close</span></button>
			</div>
			<div class="labelinputgrid">
				<label><span class="labeltext">Name</span> <input type="text" name="paramname" value=""></label>
				<label><span class="labeltext">Default Value</span> <input type="number" name="default" value="0" step="any"></label>
				<div class="optionalinput">
					<span class="labeltext">Minimum Value</span>
					<div class="inputs">
						<input type="checkbox" name="clampmin">
						<input type="number" name="min" value="-1" step="any" disabled>
					</div>
				</div>
				<div class="optionalinput">
					<span class="labeltext">Maximum Value</span>
					<div class="inputs">
						<input type="checkbox" name="clampmax">
						<input type="number" name="max" value="1" step="any" disabled>
					</div>
				</div>
				<hr>
				<label title="Non-constraining step size used in editor GUI"><span class="labeltext">Step Size (GUI only)</span> <input type="number" name="step" value="0.05" step="any"></label>
			</div>
			<div class="errortext"></div>
			<div class="buttons">
				<button class="reset" type="button" title="Reset"><span class="material-symbols-outlined">restart_alt</span></button>
				<button type="submit" disabled>Save</button>
			</div>
		</form>
	</dialog>
</body>

</html>